os: linux
dist: focal

addons:
  apt:
    packages:
      - assimp-utils
      - clang-format
      - clang-tidy
      - cmake
      - cppcheck
      - freeglut3
      - freeglut3-dev
      - glew-utils
      - libassimp-dev
      - libglew-dev
      - libglfw3
      - libglfw3-dev
      - libglm-dev
      - libglu1-mesa-dev
      - libsoil-dev
      - libxi-dev
      - libxmu-dev
      - mesa-common-dev
      - mesa-utils
      - xorg-dev

pull_request:
  branches:
    - main

notifications:
  email: false

jobs:
  include:
    - name: clang-format
    - script: clang-format for file in $(find . -iname '*.cpp' -or -iname '*.h' -and -not -iname 'doctest.h' ); do diff -u <(cat "$file") <(clang-format "$file") || exit 1; done
    - name: clang-tidy, cppcheck
    - script: cmake . -DCMAKE_CXX_FLAGS="-Werror -Wall -Wextra" && cmake --build .
